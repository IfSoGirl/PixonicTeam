/*
 * File: app/controller/MainController.js
 *
 * This file was generated by Sencha Architect version 3.2.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.4.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.4.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('PixonicTeam.controller.MainController', {
    extend: 'Ext.app.Controller',

    requires: [
        'PixonicTeam.view.SlidingMenu',
        'PixonicTeam.view.ProfilePanel',
        'PixonicTeam.view.CalendarPanel'
    ],

    config: {
        control: {
            "[action=menuButtonPressed]": {
                tap: 'onMenuButtonTap'
            },
            "[action=menuItemPressed]": {
                tap: 'onMenuItemPressed'
            },
            "listitem": {
                onListItemTap: 'OnListItemTap'
            },
            "[action /=/(?:menu)/]": {
                tap: 'onButtonTap'
            }
        }
    },

    onMenuButtonTap: function(button, e, eOpts) {
        var menus = Ext.Viewport.getMenus();
        if (Ext.Viewport.getMenus().left.isHidden()){
            Ext.Viewport.showMenu('left');
        }
        else {
            Ext.Viewport.hideMenu('left');
        }

    },

    onMenuItemPressed: function(button, e, eOpts) {
            var targetPanel;
            switch(button.id){
                case 'profileMenuItem': {
                    targetPanel = 'profilePanel';
                    break;
                }
                case 'calendarMenuItem': {
                    targetPanel = 'calendarPanel';
                    break;
                }
                case 'employeesMenuItem': {
                    targetPanel = 'employeePanel';
                    break;
                }
                default:
                    break;
            }
            this.showPanel(targetPanel);
    },

    OnListItemTap: function(listitem) {

    },

    onButtonTap: function(button, e, eOpts) {
            console.log('Its not menu opening button');
            Ext.Viewport.hideMenu('left');
    },

    launch: function() {
            console.log('Main controller launch');
            mainController = this;
            var toolbar = Ext.create('PixonicTeam.view.MainToolbar');
            toolbar.hide();
            Ext.Viewport.add(toolbar);

            Ext.Viewport.setMenu(Ext.create('PixonicTeam.view.SlidingMenu'), {
                side: 'left',
                reveal: false
            });

            Ext.Viewport.add(Ext.create('PixonicTeam.view.ProfilePanel'));
            Ext.Viewport.add(Ext.create('PixonicTeam.view.CalendarPanel'));

            Ext.Viewport.add(Ext.create('PixonicTeam.view.EmployeesNav'));

    },

    showPanel: function(panelName) {
            console.log('menu item pressed ' + panelName);
            var tab, title, enableToolbar;
            var bar = Ext.getCmp('mainToolbar');
            switch(panelName){
                case 'profilePanel': {
                    title = 'Профиль';
                    tab = Ext.getCmp('profilePanel');
                    enableToolbar = true;
                    break;
                }
                case 'calendarPanel': {
                    title = 'Календарь';
                    tab = Ext.getCmp('calendarPanel');
                     enableToolbar = true;
                    break;
                }
                case 'employeePanel': {
                    title = 'Сотрудники';
                    tab = Ext.getCmp('employeeNav');
                     enableToolbar = false;
                    break;
                }

                case 'colleaguePanel': {
                    title = 'Сотрудники';
                     enableToolbar = false;
                    tab = Ext.getCmp('colleaguePanel');
                    break;
                }
                case 'loginPanel': {
                    enableToolbar = false;
                    tab = Ext.getCmp('loginPanel');
                    loginController.showLoginElements();
                    break;
                }
                default:
                    break;
            }

            bar.setTitle(title);

            if (enableToolbar)
                bar.show();
            else
                bar.hide();
            Ext.Viewport.hideMenu('left');
            Ext.Viewport.setActiveItem(tab);
    }

});